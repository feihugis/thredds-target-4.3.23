<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html><head><meta content="text/html; charset=ISO-8859-1" http-equiv="content-type"><title>Motherlode TDS - Issues Report</title></head><body><h1>Motherlode TDS - Issues Report</h1><hr style="width: 100%; height: 2px;"><h2><a name="2008-12-30"></a>2008-12-30 - motherlode:8080 hanging (very long response times)</h2><ul><li>Assigned: Ethan</li><li>Reporter: Don</li></ul><ol><li>Try to access "/thredds/catalog.html" [waiting ...]</li><li>Check that other motherlode servers are running, e.g., 80, 8081 [all OK]</li><li>Took a look at access log
to check when last request came in/finished; if requests are still
being handled. [long response times but looks like requests are still
being handled]</li><li>Take a look at catalina.out: various ClientAbortExceptions and a OutOfMemoryError from DODSServlet.</li><li>Got response to "/thredds/catalog.html" request above.</li><li>Try to access "/thredds/debug?General/showRuntime" [waiting ...]</li><li>Take a look at threddsServlet.log [similar errors as in catalina.out, response times getting big]</li><li>Got
response to "/thredds/debug?General/showRuntime" shows total and max
memory pegged at &nbsp;2129.330176 Mb and the "main" thread group had
53 threads, ten orso were blocked, lots waiting, some runnable. </li><li>Restart TDS on 8080:</li></ol><pre style="margin-left: 40px;"><strong>motherlode.ucar.edu:</strong> sudo su tomcat<br><strong>motherlode.ucar.edu:</strong> cd /opt/tds-live/bin<br><strong>motherlode.ucar.edu:</strong> ./shutdown.sh<br><strong>motherlode.ucar.edu:</strong> ps -ef |grep java<br>  ...[see below] ...<br><strong>motherlode.ucar.edu:</strong> ./startup.sh<br></pre><p>NOTE: &nbsp;In this case, the TDS on 8080 did not shutdown so had to kill and then kill -9:</p><pre style="margin-left: 40px;"><strong>motherlode.ucar.edu:</strong> kill &lt;processId&gt;<br><strong>motherlode.ucar.edu:</strong> ps -ef |grep java<br><strong>motherlode.ucar.edu:</strong> kill -9 &lt;processId&gt;<br></pre><ol start="8"><li>Check that TDS is up: <a href="http://motherlode.ucar.edu:8080/thredds/catalog.html">http://motherlode.ucar.edu:8080/thredds/catalog.html</a></li></ol><h3>Conclusion</h3><p>Memory pegged at max. Possibly too many hung threads holding onto memory. Or some other memory leak.</p><h3>ToDo</h3><ol><li>Switch Tomcat on 8080 to run under 64-bit JVM and increase -Xmx setting (up to 4080?).</li><li>Setup some monitoring of JVM memory usage (and number of blocked threads?).</li></ol><hr style="width: 100%; height: 2px;"></body></html>