<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head><!-- $Id: DqcSpec.html,v 1.4 2004/04/02 21:29:22 edavis Exp $ --><title>Dataset Query Capabilities Specification</title></head><body>
<h1>Dataset Query Capabilities Document Specification</h1>
<p> <em>Last modified: 2 April 2004 ($Date: 2004/04/02 21:29:22 $)</em></p>
<p><em>Comments to <a href="mailto:thredds@unidata.ucar.edu">THREDDS
mail list</a> </em> </p>
<hr>
<h3>Contents:</h3>
<ul>
  <li><a href="#Overview">Overview</a></li>
  <li><a href="#DQC_Elements_and_Types">DQC Elements and Types</a></li>
  <li><a href="#Example">Example</a></li>
  <li><a href="#Notes">Notes (and Thoughts for the Future)<br>
    </a></li>
  <ul>
    <li><a href="#What_is_Returned">What is Returned</a></li>
    <li><a href="#How_is_a_Query_String_Build">How is a Query String Built</a></li>
    <li><a href="#Selectors_That_Require_Multiple_Values">Selectors that Require Multiple Values</a></li>
  </ul>
  <li><a href="#Index_of_elements_and_types">Index of Elements and Types</a><br>
  </li>
</ul>
<h3>Related Resources:</h3>
<ul>
  <li><a href="./DqcChanges.html">Changes</a> from version 0.2</li>
  <li><a href="/schemas/thredds/queryCapability.0.3.xsd">DQC schema</a> version 0.3<br>
  </li>
</ul>
<hr style="width: 100%; height: 2px;">
<h2><a name="Overview"></a>Overview</h2>
<p>A Dataset Query Capabilities (DQC) document is an XML document that describes 
  the set of requests that can be made to one or more THREDDS services. A DQC 
  document is returned when a THREDDS dataset is accessed with serviceType "QueryCapability". 
  The DQC can be thought of as an abstract description of the contents of a THREDDS 
  dataset.</p>
<p>This DQC Document Specification covers the 0.3 version of the query capabilities 
  schema (<a href="/schemas/thredds/queryCapabilities.0.3.xsd">http://www.unidata.ucar.edu/schemas/thredds/queryCapabilities.0.3.xsd</a>). 
  It explains the meanings of the individual elements that constitutes a DQC document 
  and how a DQC service request is built from the information in a DQC document.</p>
<p>Also see: <a href="../catalog/Primer.html">THREDDS Catalog Primer</a>.<br>
</p>
<h2><a name="DQC_Elements_and_Types"></a>DQC Elements and Types</h2>

<h3><a name="queryCapability_Element"></a>queryCapability Element</h3>
<pre>&lt;xsd:element name="queryCapability"&gt;<br>  &lt;xsd:complexType&gt;<br>    &lt;xsd:sequence&gt;<br>      &lt;xsd:element ref="qc:query"/&gt;<br>      &lt;xsd:element ref="qc:selector" minOccurs="1" maxOccurs="unbounded" /&gt;<br>      &lt;!-- Require a selectServiceType, more allowed because of above selector elements. --&gt;<br>      &lt;xsd:element ref="qc:selectServiceType"/&gt;<br>      &lt;xsd:element ref="qc:userInterface" minOccurs="0" maxOccurs="unbounded"/&gt;<br>    &lt;/xsd:sequence&gt;<br>    &lt;xsd:attribute name="version" type="xsd:token" default="0.3"/&gt;<br>    &lt;xsd:attribute name="name" type="xsd:token" use="optional"/&gt;<br>  &lt;/xsd:complexType&gt;<br>&lt;/xsd:element&gt;<br></pre>
<p>This is the top level element, containing one <strong style="font-style: italic;">query</strong> 
  element, one or more <strong style="font-style: italic;"> selector</strong> 
  elements, and 0 or more <strong></strong><strong style="font-style: italic;"><a href="#userInterface_Element">userInterface</a></strong> 
  elements. For example,</p>

<pre>&lt;queryCapability<br>    &nbsp;xmlns="http://www.unidata.ucar.edu/namespaces/thredds/queryCapability/v0.3"<br>     name="My collection of datasets" version="0.3"&gt;<br>  &lt;query base="http://my.server/dqcServlet/myCollection" construct="template" /&gt;<br>  &lt;selectFromRange title="Longitude" required="false"<br>    template="minLon={min}&amp;amp;maxLon={max}"<br>    min="0.0" max="360.0" units="degree_east" modulo="true" /&gt;<br>&lt;queryCapability&gt;<br></pre>
<p> </p>
<h3><a name="query_Element"></a>query Element</h3>

<pre>&lt;xsd:element name="query"&gt;<br>  &lt;xsd:complexType&gt;<br> &nbsp;  &lt;xsd:attribute name="base" type="xsd:string" use="required"/&gt;<br>    &lt;xsd:attribute name="construct" type="qc:constructType" use="required"/&gt;<br>  &lt;/xsd:complexType&gt;<br>&lt;/xsd:element&gt;<br><br>&lt;xsd:simpleType name="constructType"&gt;<br>  &lt;xsd:restriction base="xsd:token"&gt;<br>    &lt;xsd:enumeration value="paramValue" /&gt;<br>    &lt;xsd:enumeration value="template" /&gt;<br>  &lt;/xsd:restriction&gt;<br>&lt;/xsd:simpleType&gt;<br></pre>
<p>A <strong><em>query</em></strong> element provides the initial part of the 
  query string and defines what the query returns. The <em><strong>base</strong></em> 
  attribute becomes the base of the query URL.<br>
</p>
<p>Example:<br>
</p>
<pre>&lt;query base="http://my.server/dqcServlet/myCollection" construct="template" /&gt;<br></pre>
<p>How the query string is constructed depends on the value of the <span style="font-style: italic;"><span style="font-weight: bold;">construct</span></span>
attribute of the <span style="font-style: italic;"><span style="font-weight: bold;">query</span></span> element. The values
currently defined are "<span style="font-weight: bold;">paramValue</span>"
and "<span style="font-weight: bold;">template</span>". The <span style="font-style: italic;"><span style="font-weight: bold;">id</span></span>
and <span style="font-style: italic;"><span style="font-weight: bold;">template</span></span>
attributes of the <span style="font-style: italic;"><span style="font-weight: bold;">selector</span></span> elements are used in
the construction of the query string for either value of the <span style="font-style: italic;"><span style="font-weight: bold;">construct</span></span>
attribute. For the details of how to build the query string, see the <a href="#How_is_a_Query_String_Build">"How is a Query String Built" section</a> below.<br>
</p>
<p>[<span style="color: rgb(255, 0, 0);">Need to add a
"templateUrlEncoded" construct type which appends the tempalte string
to the query string seperated by ampersands ('&amp;'). For cases where
the multiple/required combo doesn't allow just appending templates due
to missing and extra ampersands. And cases where multiple values are
needed for a single selection and the default id in "id=value" is not a
unique option (e.g., when two different selectFromRange elements are
used).</span>]
</p>

<h3><a name="selector_Element"></a>selector Element</h3>

<pre>&lt;xsd:element name="selector" type="qc:selectorType" abstract="true"/&gt;<br>&lt;xsd:complexType name="selectorType"&gt;<br>  &lt;xsd:sequence&gt;<br>    &lt;xsd:element name="description" type="cat:documentationType" minOccurs="0" maxOccurs="1"/&gt;<br>  &lt;/xsd:sequence&gt;<br>  &lt;xsd:attribute name="id" type="xsd:token" use="optional"/&gt;<br>  &lt;xsd:attribute name="title" type="xsd:token" use="required"/&gt;<br>  &lt;xsd:attribute name="template" type="xsd:token" use="optional"/&gt;<br>  &lt;xsd:attribute name="required" type="xsd:boolean" default="true"/&gt;<br>  &lt;xsd:attribute name="multiple" type="xsd:boolean" default="false" /&gt;<br>&lt;/xsd:complexType&gt;<br></pre>
<p>The <span style="font-weight: bold; font-style: italic;">selector</span> element 
  is the base class for all selectors, such as <a href="#selectList_Element">selectList</a>, 
  <a href="#selectStation_Element">selectStation</a>, <a href="#selectFromRange_Element">selectFromRange</a>, 
  <a href="#selectGeoRegion_Element">selectGeoRegion</a>, and defines a single 
  selection for a user to make. The <span style="font-style: italic;"><span style="font-weight: bold;">required</span></span> 
  attribute (which defaults to "<span style="font-weight: bold;">true</span>") 
  indicates whether the user must make a selection from this selector to obtain 
  a valid query string. The <em><strong>title</strong></em> attribute is required 
  and its value is displayed to the user as the title of this selector. The contents 
  of the optional <em><strong>description</strong></em> element (plain text or 
  a combination of text and XHTML) may be displayed to the user to further describe 
  the selector. The&nbsp; <em><strong>id</strong></em> and the <span style="font-style: italic;"><span style="font-weight: bold;">template</span></span> 
  attributes are both optional and are used to build the query string. The <span style="font-style: italic;"><span style="font-weight: bold;">id</span></span> 
  attribute must be unique within a DQC document. The <span style="font-style: italic;"><span style="font-weight: bold;">multiple</span></span> 
  attribute (which defaults to "<span style="font-weight: bold;">false</span>") 
  indicates whether the user can make only one selection from this <span style="font-style: italic;"><span style="font-weight: bold;">selector</span></span> 
  or can make many selections. For example, for a <span style="font-style: italic;"><span style="font-weight: bold;">selectStation 
  </span></span> that allows the user to select from a list of stations, a user 
  can select one or more stations if <span style="font-style: italic;"><span style="font-weight: bold;">multiple</span></span> 
  is set to "<span style="font-weight: bold;">true</span>". Otherwise, only one 
  station may be selected.</p>More information on how the <em><strong>id</strong></em>, <span style="font-style: italic;"><span style="font-weight: bold;">template</span></span>, 
  and <span style="font-style: italic;"><span style="font-weight: bold;">multiple</span></span> 
  attributes are used in the building of the query string is available in the 
  <a href="#How_is_a_Query_String_Build">"How is a Query String Built" section</a> 
  below.<pre></pre>

<h3><a name="selectList_Element"></a>selectList Element</h3>
<pre>&lt;xsd:element name="selectList" substitutionGroup="qc:selector"&gt;<br>  &lt;xsd:complexType&gt;<br>    &lt;xsd:complexContent&gt;<br>      &lt;xsd:extension base="qc:selectorType"&gt;<br>        &lt;xsd:sequence&gt;<br>          &lt;xsd:element ref="qc:choice" minOccurs="1" maxOccurs="unbounded"/&gt;<br>        &lt;/xsd:sequence&gt;<br>      &lt;/xsd:extension&gt;<br>    &lt;/xsd:complexContent&gt;<br>  &lt;/xsd:complexType&gt;<br>&lt;/xsd:element&gt;<br></pre>
<p>A <em><strong>SelectList</strong></em> is a kind of selector that defines an enumerated list of choices from which the 
  user can make a selection. Each choice in the enumerated list is defined by a <strong>choice</strong> 
  element.
</p>
<p>An Example:<br>
</p>
<pre>  &lt;selectList id="item" title="An Item:" multiple="true" required="true"&gt;<br>    &lt;choice name="item 1" value="item1"/&gt;<br>    &lt;choice name="item 2" value="item2"/&gt;<br>  &lt;/selectList&gt;<br></pre>


<p>When the query construct method is set to "<span style="font-weight: bold;">template</span>", 
  the template string must contain the replacement string "{value}". The value of the <span style="font-style: italic;"><span style="font-weight: bold;">id</span></span> 
  attribute is not used. The replacement string will be replaced 
  with the value of the selection.<br>
</p>
<p>When the "<span style="font-weight: bold;">paramValue</span>" query
construct method is chosen, the parameter name will be the value of the
<span style="font-style: italic;"><span style="font-weight: bold;">id</span></span> , i.e., "&lt;id&gt;=&lt;value&gt;".<br>
</p>
<p>The value of a selection is the value of the selected <i>choice</i> element's <i>value</i> attribute.<br>
</p>
<h3><a name="choice_Element"></a>choice Element</h3>

<pre>&lt;xsd:element name="choice" type="qc:choiceType"/&gt;<br>&lt;xsd:complexType name="choiceType"&gt;<br>  &lt;xsd:sequence&gt;<br>    &lt;xsd:element name="description" type="cat:documentationType" minOccurs="0" maxOccurs="1"/&gt;<br>    &lt;xsd:element ref="qc:selector" minOccurs="0" maxOccurs="unbounded"/&gt;<br>  &lt;/xsd:sequence&gt;<br>  &lt;xsd:attribute name="name" type="xsd:string" use="required"/&gt;<br>  &lt;xsd:attribute name="value" type="xsd:string" use="required"/&gt;<br>&lt;/xsd:complexType&gt;<br></pre>

<p>A <span style="font-weight: bold; font-style: italic;">choice</span>
element specifies a single choice that the user can make
from a <span style="font-weight: bold; font-style: italic;">selectList</span>.
The <em><strong>name</strong></em> attribute is
displayed to the user, while the <em><strong>description</strong></em>
element is an optional longer description of the choice. The <em><strong>value</strong></em>
attribute of a selected choice provides the selections resulting value
which is used to construct the query.<br>
</p>
<p>Each <i>choice</i> element can contain nested <i>selector</i> elements. This allows further refinement of a selection. For example:<br>
</p>
<pre>&lt;selectList id="stations" title="Stations" template="stn={stn}"&gt;<br>  &lt;choice name="station1" value="stn1&gt;<br>    &lt;selectList id="productS1" title="Products for Station 1" template="prodS1={prod}"&gt;<br>      &lt;choice name="Temperature" value="temp" /&gt;<br>      &lt;choice name="Wind Speed" value="windSpd" /&gt;<br>      &lt;choice name="Wind Direction" value="windDir" /&gt;<br>   &nbsp;&lt;/selectList&gt;<br>  &lt;/choice&gt;<br>  &lt;choice name="station2" value="stn2&gt;<br>    &lt;selectList id="productS2" title="Products for Station 2" template="prodS2={prod}"&gt;<br>      &lt;choice name="Temperature" value="temp" /&gt;<br>      &lt;choice name="Wind U" value="windU" /&gt;<br>      &lt;choice name="Wind V" value="windV" /&gt;<br>    &lt;/selectList&gt;<br>  &lt;/choice&gt;<br>&lt;/selectList&gt;<br></pre>
<p>This allows for cases where there are different choices depending on your first choice.<br>
</p>
<p>
</p>

<h3><a name="selectServiceType_Element"></a>selectServiceType Element</h3>
<pre>&lt;xsd:element name="selectServiceType" substitutionGroup="qc:selector"&gt;<br>  &lt;xsd:complexType&gt;<br>    &lt;xsd:complexContent&gt;<br>      &lt;xsd:extension base="qc:selectorType"&gt;<br>        &lt;xsd:sequence&gt;<br>          &lt;xsd:element ref="qc:serviceType" minOccurs="1" maxOccurs="unbounded"/&gt;<br>        &lt;/xsd:sequence&gt;<br>      &lt;/xsd:extension&gt;<br>    &lt;/xsd:complexContent&gt;<br>  &lt;/xsd:complexType&gt;<br>&lt;/xsd:element&gt;<br></pre>
<p>The <i>selectServiceType</i> element is a type of <i>selector</i> that defines the possible <i>serviceType</i>s that might be returned from a query on this DQC. Having a <i>selectServiceType</i> in a DQC document allows 
  clients to filter the response on the <i>serviceType</i>s the client understands. For this reason, a <i>selectServiceType</i> element is required in all DQC documents.&nbsp;<br>
 </p>
<p>When the query construct method is set to "<span style="font-weight: bold;">template</span>", 
  the template string must contain the replacement string "{value}". The value of the <span style="font-style: italic;"><span style="font-weight: bold;">id</span></span> 
  attribute is not used. The replacement string will be replaced 
  with the value of the selection.</p>

<p>When the "<span style="font-weight: bold;">paramValue</span>" query
construct method is chosen, the parameter name will be the value of the
<span style="font-style: italic;"><span style="font-weight: bold;">id</span></span> , i.e., "&lt;id&gt;=&lt;value&gt;".<br>
</p>
<p>The value of a selection is the value of the selected <i>serviceType</i> element's <i>value</i> attribute.<br>
</p>
<p>Example:<br>
</p>
<pre>&lt;selectServiceType id="serviceType" title="Select service type(s)" required="false"<br>    template="serviceType={value}" multiple="false"&gt;<br>  &lt;serviceType name="OPeNDAP/DODS" value="DODS"/&gt;<br>&lt;/selectServiceType&gt;<br></pre>

<h3><a name="serviceType_Element"></a>serviceType Element</h3>
<pre>&lt;xsd:element name="serviceType"&gt;<br>  &lt;xsd:complexType&gt;<br>    &lt;xsd:sequence&gt;<br>      &lt;xsd:element name="description" type="cat:documentationType" minOccurs="0" maxOccurs="1"/&gt;<br>    &lt;/xsd:sequence&gt;<br>    &lt;xsd:attribute name="name" type="xsd:string" use="required"/&gt;<br>    &lt;xsd:attribute name="value" type="cat:serviceTypes" use="required"/&gt;<br>  &lt;/xsd:complexType&gt;<br>&lt;/xsd:element&gt;</pre>
<p>The <i>serviceType</i> element specifies a single THREDDS catalog service type (see the <a href="/projects/THREDDS/tech/catalog/InvCatalogSpec.html">THREDDS catalog specification</a>
for more information). This element encapsulates the catalog service
types and allows the addition of some descriptive information with the <i>name</i> attribute and the <i>description</i> element.<br>
</p><h3><a name="selectStation_Element"></a> selectStation Element</h3>
<pre>&lt;xsd:element name="selectStation" substitutionGroup="qc:selector"&gt;<br>  &lt;xsd:complexType name="selectStationType"&gt;<br>    &lt;xsd:complexContent&gt;<br>      &lt;xsd:extension base="qc:selectorType"&gt;<br>        &lt;xsd:sequence&gt;<br>          &lt;xsd:element ref="qc:station" minOccurs="1" maxOccurs="unbounded"/&gt;<br>        &lt;/xsd:sequence&gt;<br>      &lt;/xsd:extension&gt;<br>    &lt;/xsd:complexContent&gt;<br>  &lt;/xsd:complexType&gt;<br>&lt;/xsd:element&gt;<br></pre>
<p>A <em><strong>selectStation</strong></em> is a kind of <span style="font-weight: bold; font-style: italic;">selector</span>
that allows the user to select from an enumerated list of <strong>station</strong>
elements. It is similar to the <span style="font-style: italic;"><span style="font-weight: bold;">selectList</span></span> element but
specialized to handle geographically located stations.<br>
</p>
<p>When the query construct method is set to "<span style="font-weight: bold;">template</span>", 
  the template string must contain the replacement string "{value}". The value of the <span style="font-style: italic;"><span style="font-weight: bold;">id</span></span> 
  attribute is not used. The replacement string will be replaced 
  with the value of the selection.<br>
</p>

<p>When the "<span style="font-weight: bold;">paramValue</span>" query
construct method is chosen, the parameter name will be the value of the
<span style="font-style: italic;"><span style="font-weight: bold;">id</span></span> , i.e., "&lt;id&gt;=&lt;value&gt;".<br>
</p>

The value of a selection is the value of the selected <i>station</i> element's <i>value</i> attribute.<br>
<br>
Example:<br>
<pre>&lt;selectStation title="Available Stations" template="stn={value}"&gt;<br>  &lt;station name="LOS_ANGELES/Orcutt_Oil_Field CA" value="VBX"&gt;<br>    &lt;location latitude="34.83" longitude="-120.38"/&gt;<br>  &lt;/station&gt;<br>  &lt;station name="OKLAHOMA_CITY/Kegelman_Aux_F OK" value="VNX"&gt;<br>    &lt;location latitude="36.73" longitude="-98.12"/&gt;<br>  &lt;/station&gt;<br>&lt;/selectStation&gt;<br></pre>
<p>
</p>


<h3><a name="station_Element"></a>station Element</h3>

<pre>&lt;xsd:element name="station" substitutionGroup="qc:choice"&gt;<br>  &lt;xsd:complexType name="stationType"&gt;<br>    &lt;xsd:complexContent&gt;<br>      &lt;xsd:extension base="qc:choiceType"&gt;<br>        &lt;xsd:sequence&gt;<br>          &lt;xsd:element ref="qc:location"/&gt;<br>        &lt;/xsd:sequence&gt;<br>      &lt;/xsd:extension&gt;<br>    &lt;/xsd:complexContent&gt;<br>  &lt;/xsd:complexType&gt;<br>&lt;/xsd:element&gt;<br></pre>
<p>A <em><strong>station</strong></em> element is an
extention of a
choice element that is specific to geographically located stations in
that it specifies a location. It contains exactly one <strong>location</strong>
element. It inherits the <strong>name</strong>, <strong>description</strong>
and <strong>value</strong> attributes from the <strong>choice</strong>
type. It is used in conjunction with the <span style="font-weight: bold; font-style: italic;">selectStation</span>
element.<br>
</p>

<h3><a name="location_Element"></a>location Element</h3>
<pre>&lt;xsd:element name="location" type="qc:locationType"/&gt;<br>&lt;xsd:complexType name="locationType"&gt;<br>  &lt;xsd:attribute name="latitude" type="xsd:float" use="required"/&gt;<br>  &lt;xsd:attribute name="longitude" type="xsd:float" use="required"/&gt;<br>  &lt;xsd:attribute name="latitude_units" type="xsd:token" default="degrees_north"/&gt;<br>  &lt;xsd:attribute name="longitude_units" type="xsd:token" default="degrees_east"/&gt;<br>&lt;/xsd:complexType&gt;<br></pre>
<p>A <em><strong>location</strong></em> element has a <strong><em>latitude</em></strong>
and <strong><em>longitude</em></strong>, and optionally may contain
units for the latitude and longitude<em><strong></strong></em>.
The units default to "degrees_north" and "degrees_east", meaning decimal degrees. The convention
for longitude is that 0 is greenwich, with positive going east, and the
numbers will be interpreted modulo 360. The default for latittude is 0
is the equator with positive going north, and must be in the range +/-
90.</p>

<h3><a name="location3D_Element"></a>location3D Element</h3>
<pre>&lt;xsd:element name="location3D" substitutionGroup="qc:location"&gt;<br>  &lt;xsd:complexType&gt;<br>    &lt;xsd:complexContent&gt;<br>      &lt;xsd:extension base="qc:locationType"&gt;<br>        &lt;xsd:attribute name="elevation" type="xsd:float" use="required"/&gt;<br>        &lt;xsd:attribute name="elevation_units" type="xsd:token" default="msl"/&gt;<br>      &lt;/xsd:extension&gt;<br>    &lt;/xsd:complexContent&gt;<br>  &lt;/xsd:complexType&gt;<br>&lt;/xsd:element&gt;<br></pre>
<p>A <strong><em>location3D</em></strong> element extends
the <strong>location</strong>
type by adding an <em><strong>elevation</strong></em> attribute to
indicate the vertical location. The <em><strong>elevation_unit</strong></em><strong><em>s</em></strong>
attribute specifies the units of the elevation.</p>

<h3><a name="selectFromRange_Element"></a> selectFromRange Element</h3>
<pre>&lt;xsd:element name="selectFromRange" substitutionGroup="qc:selector"&gt;<br>  &lt;xsd:complexType&gt;<br>    &lt;xsd:complexContent&gt;<br>      &lt;xsd:extension base="qc:selectorType"&gt;<br>        &lt;xsd:attribute name="min" type="xsd:float" use="required" /&gt;<br>        &lt;xsd:attribute name="max" type="xsd:float" use="required" /&gt;<br>        &lt;xsd:attribute name="units" type="xsd:string" use="optional" /&gt;<br>        &lt;xsd:attribute name="modulo" type="xsd:boolean" default="false" /&gt;<br>        &lt;xsd:attribute name="selectType" type="qc:rangeSelectTypeEnum" use="required" /&gt;<br>      &lt;/xsd:extension&gt;<br>    &lt;/xsd:complexContent&gt;<br>  &lt;/xsd:complexType&gt;<br>&lt;/xsd:element&gt;<br><br>&lt;xsd:simpleType name="rangeSelectTypeEnum"&gt;<br>  &lt;xsd:restriction base="xsd:token"&gt;<br>    &lt;xsd:enumeration value="point" /&gt;<br>    &lt;xsd:enumeration value="range" /&gt;<br>    &lt;!--xsd:enumeration value="pointOrRange"/--&gt;<br>  &lt;/xsd:restriction&gt;<br>&lt;/xsd:simpleType&gt;<br></pre>

<p>A <em><strong>selectFromRange</strong></em> element is a kind of
<i><span style="font-weight: bold; font-style: italic;">selector</span></i>
that
defines a range of numbers from which a user can select a point or a range. The given range is defined by
the values of the <span style="font-style: italic;"><span style="font-weight: bold;">min</span></span> and <span style="font-style: italic;"><span style="font-weight: bold;">max</span></span>
attributes. The units of the given values and the selected value(s) is given by the value of the <i>units</i> attribute. Defining the <i>modulo</i>
attribute true means that the given range is cyclic and the modulo
value can be calculated by taking the maximum value and subtracting the
minimum value. E.g., longitude from -180.0 to 180.0 has a modulo value of 360.0 as does the longitude range from 0.0 to 360.0. The <i>selectType</i> attribute indicates whether a single point or a range is expected.<span style="color: rgb(255, 0, 0);"><span style="color: rgb(0, 0, 0);"><br>
</span></span></p>
<p>When the query construct method is set to "template" and the value of the <i>selectType</i> attribute is set to "point", 
  the template string must contain the replacement string "{point}". When the <i>selectType</i> attribute is set to "range", the template string must contain the replacement strings "{min}" and "{max}".&nbsp; The value of the <span style="font-style: italic;"><span style="font-weight: bold;">id</span></span> 
  attribute, if given, is not used. The replacement strings will be replaced 
  with the value(s) of the selection.</p>


<p>When the "<span style="font-weight: bold;"></span>paramValue" query
construct method is chosen and the value of the <i>selectType</i> attribute is set to "point", the string "point=&lt;pntValue&gt;" will be appended to the query string. When the <i>selectType</i> attribute is set to "range", the string "min=&lt;minValue&gt;&amp;max=&lt;maxValue&gt;" will be appended to the query string.<br>
</p>
<p><span style="color: rgb(255, 0, 0);"><span style="color: rgb(0, 0, 0);"> The selected 
  values must be within the given range and the minimum value must be less 
  than the maximum value unless modulo is set to true. If modulo is true and the 
  selected minimum is greater than the selected maximum, it means that the selected 
  range crosses the modulo boundary).<br>
</span></span></p>
<p><span style="color: rgb(255, 0, 0);"><span style="color: rgb(0, 0, 0);">Example:<br>
</span></span></p>
<pre>&lt;selectFromRange title="Longitude" required="false"<br>  selectType="range" template="minLon={min}&amp;amp;amp;maxLon={max}"<br>  min="0.0" max="360.0" units="degree_east" modulo="true" /&gt;<br></pre>
<p>[<span style="color: rgb(255, 0, 0);">There is currently no way to allow the 
  user to select either a point or a range, it must be one or the other. See <a href="#Selectors_That_Require_Multiple_Values">below</a>.</span>]<br>
[<span style="color: rgb(255, 0, 0);">Is the point case needed and what does it mean (find the closest?)? Is it the same&nbsp; min=max?</span>]<br>
</p>


<h3><a name="selectFromDateRange_Element"></a>selectFromDateRange Element</h3>
<pre>&lt;xsd:element name="selectFromDateRange" substitutionGroup="qc:selector"&gt;<br>  &lt;xsd:complexType name="selectFromDateRangeType"&gt;<br>    &lt;xsd:complexContent&gt;<br>      &lt;xsd:extension base="qc:selectorType"&gt;<br>        &lt;xsd:attribute name="start" type="cat:dateType" use="optional" /&gt;<br>        &lt;xsd:attribute name="end" type="cat:dateType" use="optional" /&gt;<br>        &lt;xsd:attribute name="duration" type="cat:duration" use="optional"/&gt;<br>        &lt;xsd:attribute name="selectType" type="qc:dateRangeSelectTypeEnum" use="required" /&gt;<br>     &nbsp;&lt;/xsd:extension&gt;<br>    &lt;/xsd:complexContent&gt;<br>  &lt;/xsd:complexType&gt;<br>&lt;/xsd:element&gt;<br><br>&lt;xsd:simpleType name="dateRangeSelectTypeEnum"&gt;<br>  &lt;xsd:restriction base="xsd:token"&gt;<br>    &lt;xsd:enumeration value="point"/&gt;<br>    &lt;xsd:enumeration value="startEnd"/&gt;<br>    &lt;xsd:enumeration value="startDuration"/&gt;<br>    &lt;xsd:enumeration value="endDuration"/&gt;<br>  &lt;/xsd:restriction&gt;<br>&lt;/xsd:simpleType&gt;<br><br></pre>
<p>A <i><b>selectFromDateRange</b></i> element is a kind of <i><b>selector</b></i>
that defines a date range from which a user may select a point or a
range. The given date range is defined by the values of the <i>start</i>, <i>end</i>, and <i>duration</i>
attributes. Only two of the three attributes can be present in a given <i>selectFromDateRange</i>.
The given start and end values are ISO8601 encoded
dates or date/times (e.g., 2004-03-04T17:30) or the string "present".
The given duration value is an ISO8601 encoded duration (e.g., <span style="color: rgb(255, 0, 0);"><span style="color: rgb(0, 0, 0);">"2Y5M1DT1H3M"</span></span>). The <i>selectType</i> attribute indicates whether a single point or a range (start/end, start/duration, or end/duration) is expected.<br>
</p>
<p>When the query construct method is set to "template", the required replacement strings depend on the value of the <i>selectType</i> attribute. When the <i>selectType</i> attribute is set to "point", 
  the template string must contain the replacement string "{point}". When the <i>selectType</i> attribute is set to "startEnd", the template string must contain the replacement strings "{start}" and "{end}". When <span style="color: rgb(255, 0, 0);"><span style="color: rgb(0, 0, 0);">the value is "startDuration", the </span></span><span style="color: rgb(255, 0, 0);"><span style="color: rgb(0, 0, 0);">template string must contain the replacement strings "{start}" and </span></span><span style="color: rgb(255, 0, 0);"><span style="color: rgb(0, 0, 0);">"{duration}"</span></span><span style="color: rgb(255, 0, 0);"><span style="color: rgb(0, 0, 0);">. </span></span><span style="color: rgb(255, 0, 0);"><span style="color: rgb(0, 0, 0);">If the value is "endDuration", the </span></span><span style="color: rgb(255, 0, 0);"><span style="color: rgb(0, 0, 0);">template string must contain the replacement strings "{end}" and </span></span><span style="color: rgb(255, 0, 0);"><span style="color: rgb(0, 0, 0);">"{duration}"</span></span><span style="color: rgb(255, 0, 0);"><span style="color: rgb(0, 0, 0);">.</span></span><span style="color: rgb(255, 0, 0);"><span style="color: rgb(0, 0, 0);"> </span></span><span style="color: rgb(255, 0, 0);"><span style="color: rgb(0, 0, 0);">The selected date range must be within the given range.</span></span> The value of the <span style="font-style: italic;"><span style="font-weight: bold;">id</span></span> 
  attribute, if given, is not used. The replacement strings will be replaced 
  with the value(s) of the selection.</p>



<p>When the "paramValue" query
construct method is chosen and the value of the <i>selectType</i> attribute is set to "point", the string "point=&lt;pntValue&gt;" will be appended to the query string. When the <i>selectType</i>
attribute is set to "startEnd", the string
"start=&lt;startValue&gt;&amp;end=&lt;endValue&gt;" will be appended to
the query string.When the  <i>selectType</i> attribute is set to "startDuration", the string
"start=&lt;startValue&gt;&amp;duration=&lt;durationValue&gt;" will be appended to
the query string. When the <i>selectType</i> attribute is set to "endDuration", the string
"end=&lt;endValue&gt;&amp;duration=&lt;durationValue&gt;" will be appended to
the query string.
</p>

<p><span style="color: rgb(255, 0, 0);"><span style="color: rgb(0, 0, 0);"> The selected 
  values must be within the given range and the start value must be less 
  than the end value.<br>
</span></span></p>
<p><span style="color: rgb(255, 0, 0);"><span style="color: rgb(0, 0, 0);">Example:<br>
</span></span></p>
<pre><span style="color: rgb(255, 0, 0);"><span style="color: rgb(0, 0, 0);">&lt;selectFromDateRange title="a date range"<br>  selectType="endDuration" template="endDate={end}&amp;amp;duration={duration}"<br>  end="present" duration="P5D" /&gt;</span></span></pre>


<p>[<span style="color: rgb(255, 0, 0);">There is currently no way to allow the 
  user to select either a point or a range, it must be one or the other. See <a href="file:///C:/Ethan/dev/thredds/catalog/doc/DqcSpec.html#Selectors_That_Require_Multiple_Values">below</a>.</span>]<br>
[<span style="color: rgb(255, 0, 0);">Is the point case needed and what does it mean (find the closest?)? Is it the same&nbsp; start=end or duration=0?</span>]<br>
</p>

<p></p>

<h3><a name="selectFromGeoRegion_Element"></a>selectFromGeoRegion Element</h3>
<pre>&lt;xsd:element name="selectFromGeoRegion" substitutionGroup="qc:selector"&gt;<br>  &lt;xsd:complexType&gt;<br>    &lt;xsd:complexContent&gt;<br>      &lt;xsd:extension base="qc:selectorType"&gt;<br>        &lt;xsd:choice&gt;<br>          &lt;xsd:element ref="qc:geoBoundingBox"/&gt;<br>        &lt;/xsd:choice&gt;<br>      &lt;/xsd:extension&gt;<br>    &lt;/xsd:complexContent&gt;<br>  &lt;/xsd:complexType&gt;<br>&lt;/xsd:element&gt;<br></pre><p>A <em><strong>selectFromGeoRegion</strong></em> element is a kind of
<span style="font-weight: bold; font-style: italic;">selector</span> that
defines a geographic region from which a user can select a geographic bounding box. The given geographic region is defined by a <i><b>geoBoundingBox</b></i> element. The requested geographic region must be fully located inside the defined geographic region.
</p>
<p>Four values are required to define the selected bounding box: the
minimum latitude, maximum latitude,&nbsp; minimum longitude, and
maximum longitude. If the query construct method is "template", the
replacement strings&nbsp; in the template string must be
'{minLat}','{minLon}', '{maxLat}', and '{maxLon}', e.g.,
"lat&gt;{minLat}&amp;lat&lt;:{maxLat}...". If the query construct
method is "paramValue", the string
"minLat=&lt;minLatValue&gt;&amp;minLon=&lt;minLonValue&gt;&amp;maxLat=&lt;maxLatValue&gt;&amp;maxLon=&lt;maxLonValue&gt;'"
will be appended to the query string.<br>
</p>
<p>Example:<br>
</p>
<pre>&lt;selectFromGeoRegion title="Geographic Coverage"<br>    selectType="range" template="minLat={minLat}&amp;amp;maxLat={maxLat}&amp;amp;minLon={minLon}&amp;amp;maxLon={maxLon}"&gt;<br>  &lt;geoBoundingBox&gt;<br>    &lt;upperLeft latitude="45.0" longitude="-110.0" /&gt;<br>    &lt;lowerRight latitude="40.0" longitude="-105.0" /&gt;<br>  &lt;/geoBoundingBox&gt;<br>&lt;/selectFromGeoRegion&gt;<br><br></pre>
<p>
</p>

<p>[<span style="color: rgb(255, 0, 0);">There is currently no way to allow the user to select either a point or a range, it must be one or the other. See <a href="file:///C:/Ethan/dev/thredds/catalog/doc/DqcSpec.html#Selectors_That_Require_Multiple_Values">below</a>.</span>]<br>
[<span style="color: rgb(255, 0, 0);">Is the point case needed and what does it mean (find the closest?)? Is it the same&nbsp; min*=max*?</span>]<br>
</p>
<span style="color: rgb(255, 0, 0);"><span style="color: rgb(0, 0, 0);"></span></span>

<h3><a name="geoBoundingBox_Element"></a>geoBoundingBox Element</h3>
<pre>&lt;xsd:element name="geoBoundingBox"&gt;<br>  &lt;xsd:complexType&gt;<br>    &lt;xsd:sequence&gt;<br>      &lt;xsd:element name="lowerLeft" type="qc:locationType"/&gt;<br>      &lt;xsd:element name="upperRight" type="qc:locationType"/&gt;<br>    &lt;/xsd:sequence&gt;<br>  &lt;/xsd:complexType&gt;<br>&lt;/xsd:element&gt;<br><br></pre>
<p>A <strong><em>geoBoundingBox</em></strong> element defines a lat/lon bounding 
  box using two <i><b>location</b></i> elements. The <i><b>lowerLeft</b></i> element 
  defines the minimum latitude and minimum longitude of the bounding box. The 
  <i><b>upperRight</b></i> element defines the maximum latitude and maximum longitude 
  of the bounding box. The location the <i><b>lowerLeft</b></i> element defines 
  must be south-west of the location defined by the <i><b>upperRight</b></i> element. Latitudes must be handled in a modulo fashion.<br>
</p>
<p>[<span style="color: rgb(255, 0, 0);">Not sure what I really mean about the modulo stuff.</span>]<br>
</p>

<p>
</p>


<h3><a name="userInterface_Element"></a>userInterface Element</h3>
<pre>&lt;xsd:element name="userInterface"&gt;<br>  &lt;xsd:complexType&gt;<br>    &lt;xsd:sequence&gt;<br>      &lt;xsd:any minOccurs="0" maxOccurs="unbounded" processContents="skip"/&gt;<br>    &lt;/xsd:sequence&gt;<br>  &lt;/xsd:complexType&gt;<br>&lt;/xsd:element&gt;<br></pre>
<p>A <em><strong>userInterface</strong></em> element is a
container
for zero or more elements that can be anything.</p>
<br>
<hr>
<h2><a name="Example"></a>Example</h2>
<p>Here is an example THREDDS dataset that, when accessed, results in a
DQC document (note, the serviceType is "queryCapability"):<br>
</p>
<pre>&lt;dataset name="NEXRAD data" &gt;<br>  &lt;access serviceType="queryCapability" urlPath="http://www/dqc/radar.xml" /&gt;<br>&lt;/dataset&gt;<br></pre>
<p>The resulting DQC document:<br>
</p>
<pre>&lt;queryCapability&gt;<br>  &lt;query base="http://www/dqc/radar" construct="paramValue" /&gt;<br><br>  &lt;selectStation id="station" title="Stations:"<br>    multiple="true" required="true"&gt;<br><br>    &lt;station name="ANCHORAGE/Bethel AK" value="ABC"&gt;<br>      &lt;location latitude="60.78" longitude="-161.87"/&gt;<br>    &lt;/station&gt;<br>    &lt;station name="ABERDEEN/Aberdeen SD" value="ABR"&gt;<br>      &lt;location latitude="45.45" longitude="-98.4"/&gt;<br>    &lt;/station&gt;<br>  &lt;/selectStation&gt;<br><br>  &lt;selectList id="product" title="Products:"<br>    multiple="true" required="true"&gt;<br><br>    &lt;choice name=".5 reflectivity .54nm res" value="N0R"<br>      description=".5 reflectivity .54nm res 16 levels id 19/r"/&gt;<br>    &lt;choice name=".5 storm rel. velocity" value="N0S"<br>      description=".5 storm rel. velocity .54nm res 16 lvls id 56/srm"/&gt;<br>  &lt;/selectList&gt;<br><br>  &lt;selectList id="time" title="Times:" required="true"&gt;<br>    &lt;choice name="Latest" value="latest"/&gt;<br>    &lt;choice name="Last hour" value="1hour"/&gt;<br>  &lt;/selectList&gt;<br>&lt;/queryCapability&gt;</pre>
<p>From the given DQC document, the client (e.g., a user interface)
builds a query string:<br>
</p>
<pre>http://www/dqc/radar?stn=ABC&amp;stn=ABR&amp;product=NOS&amp;time=latest<br></pre>
<p>When accessed, the query string resolves into, in this case, a
coherant collection dataset with collectionType="stations":<br>
</p>
<pre>&lt;catalog&gt;<br>  &lt;dataset name="Latest NOS NEXRAD product from ABC and ABR" collectionType="stations"&gt;<br>    &lt;service name="mlode" base="http://www/data/radar" /&gt;<br>    &lt;dataset name="Latest .5 storm relative velocity product from Bethel, AK"&gt;<br>        &lt;access serviceName="mlode" urlType="NOS/ABC/2003121600_NOS.nc" /&gt;<br>    &lt;/dataset&gt;<br>    &lt;dataset name="Latest .5 storm relative velocity product from Aberdeen, SD"&gt;<br>        &lt;access serviceName="mlode" urlType="NOS/ABR/2003121600_NOS.nc" /&gt;<br>    &lt;/dataset&gt;<br>  &lt;/dataset&gt;<br>&lt;/catalog&gt;<br></pre>
<hr><br>
<h2><a name="Notes"></a>Notes</h2>

<h3><a name="What_is_Returned"></a>What is Returned</h3>
<p>Currently, a resulting queryURL can return a THREDDS catalog. DQC
documents could be used to build queryURLs that reference non-THREDDS
services, e.g., an OPeNDAP server. The results of dereferencing a
queryURL in these cases would be dependent on the service and,
currently, can not
be represented in the DQC document other than with an "other" value in
the returns attribute of the query element. How a queries returns type
is indicated may need to be expanded if the DQC is used in other
contexts.<br>
</p>
<h4>Further Discussion of Return Type</h4>
<p>We have decided not to investigate other return types until we have
more need for them.<br>
</p>
<p>Some thoughts:<br>
</p>
<ul>
  <li>What is the DQC:</li>
  <ul>
    <li>a redirection layer</li>
    <li>a more complex access method (a subsetting access method)<br>
    </li>
  </ul>
  <li>What is the result of the DQC:</li>
  <ul>
    <li>a queryURL that returns catalog (no crossing of the protocol
boundary)</li>
    <li>a queryURL that returns a dataset, e.g., DODS data (cross the
protocol boundary)</li>
    <ul>
      <li>Can't allow client to get queryURL and then try to constrain
further. E.g., ?xy[10:13]?xy[0] causes error instead of returning
xy[10] of the original var. However, since a DQC result is generally a
final result that is then dereferenced this shouldn't happen. Is this
related to the "Resolver" idea? Could we use the DQC to provide more
information on "Resolver" issues? E.g., if time range is selected,
result is a "time series".<br>
      </li>
    </ul>
    <li>a catalog, i.e., tempate as catalog. For example
template="&lt;catalog&gt;&lt;dataset urlpath={path}&gt;&lt;service
name="xyz"/&gt;&lt;metadata&gt;abc&lt;/metadata&gt;&lt;/dataset&gt;"</li>
    <ul>
      <li>This keeps things more cleanly in the THREDDS realm (i.e.,
queryURL is the access method)<br>
      </li>
    </ul>
  </ul>
  <li>the queryURL is a urlPath of a dataset (e.g., DODS URL w/ CE)</li>
  <li>DQC just another way to build an access URL (like serviceBase +
urlPath) but that allows subsetting<br>
  </li>
  <ul>
    <li>How differentiate between access to full dataset and subset of
dataset?</li>
  </ul>
</ul>
<h4>DODS File Server (DFS) Thoughts</h4>
<p>Several possibilities:<br>
</p>
<ul>
  <li>Build DQC documents that build a DFS query. So return is a DODS
dataset containing catalog information.</li>
  <ul>
    <li>Pros</li>
    <ul>
      <li>Could be done<br>
      </li>
    </ul>
    <li>Cons</li>
    <ul>
      <li>Requires crossing of THREDDS/DODS protocol boundary before
out of catalog realm<br>
      </li>
    </ul>
    <ul>
      <li>Might require some added complexity to the DQC spec?<br>
      </li>
      <li>No metadata for each dataset except for selection criterion
columns<br>
      </li>
    </ul>
  </ul>
  <li>Build DQC document that describes a DFS and service that replys
with THREDDS catalog. <br>
  </li>
  <ul>
    <li>On top of existing DFS</li>
    <li>Replace existing DFS<br>
    </li>
  </ul>
</ul>

<h3><a name="How_is_a_Query_String_Build"></a>How is a Query String Build</h3>

<p>To build a query string from a DQC document, the user makes a
valid selection for each <span style="font-weight: bold; font-style: italic;">selector</span>
element that is required (the <span style="font-weight: bold; font-style: italic;">require</span>
attribute defaults to "<span style="font-weight: bold;">true</span>")
and optionally for each <span style="font-weight: bold; font-style: italic;">selector</span> element
that is not required. There are two ways the query string can be constructed corresponding to the 
  two allowed values of the <span style="font-style: italic;"><span style="font-weight: bold;">construct</span></span> 
  attribute of the <span style="font-style: italic;"><span style="font-weight: bold;">query</span></span> 
  element.<br>
</p>
<p>When the <span style="font-style: italic;"><span style="font-weight: bold;">construct</span></span> 
  value is set to "<span style="font-weight: bold;">template</span>", the query 
  string is appended with the expanded value of the <span style="font-style: italic;"><span style="font-weight: bold;">template</span></span> 
  attribute from each <span style="font-style: italic;"><span style="font-weight: bold;">selector</span></span> 
  element. The value of the <span style="font-style: italic;"><span style="font-weight: bold;">template</span></span> 
  attribute must be a string containing one or more replacement strings. A replacement 
  string is any percent sign delimited string, e.g., "{min}". The template string 
  is expanded by replacing each replacement string with the appropriate value 
  from the selection. If the template contains more than one replacement string, 
  it means that the <span style="font-style: italic;"><span style="font-weight: bold;">selector</span></span> 
  requires more than one value to make a valid selection. This is different than 
  setting the <span style="font-style: italic;"><span style="font-weight: bold;">multiple</span></span> 
  attribute to "<span style="font-weight: bold;">true</span>" which indicates 
  that multiple selections can be made on the <span style="font-style: italic;"><span style="font-weight: bold;">selector</span></span> 
  whether each selection requires one value or several values. When multiple selections 
  are made on the same <span style="font-style: italic;"><span style="font-weight: bold;">selector</span></span>, 
  the template string is appended to the query string once for each selection, 
  expanded appropriately.</p>
<p>When the <span style="font-style: italic;"><span style="font-weight: bold;">construct</span></span> value is set to "<span style="font-weight: bold;">paramValue</span>", the query string is
appended with parameter/value pairs where <span style="font-style: italic;"><span style="font-weight: bold;">id</span></span>
is the name of the parameter and the value from the users selection is
the parameters value, e.g., "min=5.3". The parameter value pairs from
each <span style="font-style: italic;"><span style="font-weight: bold;">selector</span></span>
are appended to the query string in a standard URL manner [??using the standard URL-encoding rules], e.g.,
"?min=5.3&amp;max=7.8", in the order the <span style="font-style: italic;"><span style="font-weight: bold;">selector</span></span>
elements appear in the DQC document. When multiple selections are made
on the same <span style="font-style: italic;"><span style="font-weight: bold;">selector</span></span>, the parameter/value
pair for that <span style="font-style: italic;"><span style="font-weight: bold;">selector</span></span> is appended to the
query string once for each selection using the value of that selection
as the parameter value.</p>
<p><a name="multiple"></a>The <span style="font-weight: bold; font-style: italic;">multiple</span>
attribute when set to "<span style="font-weight: bold;">true</span>"
(the default is "<span style="font-weight: bold;">false</span>") means
that the user may make more than one selection from a single <span style="font-weight: bold; font-style: italic;">selector</span>. When
more than one selection is made from the same <span style="font-weight: bold; font-style: italic;">selector</span>, the
information for each selection is simply appended to the query string
in the manner defined by the construction type. The information for
each selection must be appended as an atomic unit, i.e., if multiple
values are required, the values from the same selection are together
(e.g., "min=1&amp;max=2&amp;min=5&amp;max=6" rather than
"min=1&amp;min=5&amp;max=2&amp;max=6". The order of the selections is
not defined (e.g., either "min=1&amp;max=2&amp;min=5&amp;max=6" or
"min=5&amp;max=6&amp;min=1&amp;max=2"
is fine).<br>
</p>
<p>What constitutes a valid selection is defined by the <span style="font-weight: bold; font-style: italic;">selector</span>
element. Some selections may consist of a single value,e.g., a station
selection requires the station name. Other selections may require
multiple values, e.g., both a minimum value and a maximum value are
required to select a time range. (Note that this is different than
allowing multiple selections from the same <span style="font-weight: bold; font-style: italic;">selector</span>
element, see the discussion of the <span style="font-weight: bold; font-style: italic;">multiple</span>
attribute <a href="file:///C:/Ethan/dev/thredds/catalog/doc/DqcSpec.html#multiple">below</a>.) The <span style="font-weight: bold; font-style: italic;">selector</span> element
defines the values required for a given selection in various ways
depending on the construction type.<br>
</p>

<h3><a name="Selectors_That_Require_Multiple_Values"></a><span style="color: rgb(0, 0, 0);">Selectors That Require Multiple Values</span></h3>
<p><span style="color: rgb(0, 0, 0);">"How to Indicate a Selector
Requires More than One Value" OR "Replacement Strings/Macros vs
Selection Items"</span></p>

<p>Reasons we might want <span style="font-weight: bold; font-style: italic;">selectionItem</span>
type functionality:<br>
</p>
<ul>
  <li>So DQC can specify that different selectionItems can satisfy a
selection (i.e., allow and/or of items). For instance, in the <span style="font-style: italic;"><span style="font-weight: bold;">selectStation</span></span>
element could allow selection of one <span style="font-weight: bold; font-style: italic;">station </span>or one <span style="font-weight: bold; font-style: italic;">boundingBox</span>. Or
selectFromRange can allow selection of&nbsp; a range (i.e., one
selectItem for min value and one for max value) or selection of a point
(i.e., selectItem for point)</li>
  
</ul>
<p>Example for range where either a point or a range may be selected:<br>
</p>
<pre>&lt;selectFromRange title="Select Date Range" required="false"<br>                 min="17193600.0" max="157680000.0" units="seconds since 1999-01-01"&gt;<br>  &lt;selectionItemOR id="dateRange" template="{dateRange}"&gt;<br>    &lt;selectionItemAND&gt;<br>      &lt;selectionItem id="min" template="minDate={min}" /&gt;<br>      &lt;selectionItem id="max" template="maxDate={max}" /&gt;<br>    &lt;/selectionItemAND&gt;<br>    &lt;selectionItem id="point" template="pointDate={point}" /&gt;<br>  &lt;/selectionItemOR&gt;<br>&lt;/selectFromRange&gt;<br></pre>

<h4>Macros (Replacement Strings)</h4>
<p>Currently, selectors that require multiple values are indicated by
the template containing multiple replacement strings (or macros), e.g.,
template="min={min}max={max}". The set of allowed replacement strings
is defined (in the spec only) for each selector that requires multiple
values. Which combinations of the replacement strings are also defined
only in the spec. For instance, the <span style="font-weight: bold; font-style: italic;">selectFromRange</span>
element defines {min}, {max}, {units}, {point}, and {proximity} where
there are two possibilities for use. Either {min} and {max} may be used
or {point} and {proximity} may be used (though {proximity} is
optional). In both cases {units} may be used.<br>
</p>
<p>Pros<br>
</p>
<ul>
  <li>simple</li>
  <li>template can be fairly complicated</li>
</ul>
<p>Cons<br>
</p>
<ul>
  <li>Does not take advantage of XML encoding for structured
information. I.e., requires the apps (not XML parser) to parse
attribute structure. (If
attribute needs structure, maybe it should be an element.)</li>
  <li>can't be used when construction type is "paramValue" (or rather
it can't be guarenteed that the template fits in the "paramValue"
scheme)???</li>
  <li>when elements aren't required and or multiple selections are
allowed, can be hard to get delimiters between values correct. E.g., if
all selectors are optional and no selection on the final selector is
made, might end up with "...?min=5&amp;max=6&amp;stn=AKC&amp;"<br>
  </li>
</ul>
<h4>Selection Items</h4>
Alternate:<br>
<ul>
  <li><span style="font-weight: bold; font-style: italic;">queryCapability</span>
element contains 0..* <span style="font-weight: bold; font-style: italic;">selection</span>
elements</li>
  <li><span style="font-style: italic;"><span style="font-weight: bold;">selection</span></span>
element contains 0..* <span style="font-style: italic;"><span style="font-weight: bold;">selectionItem</span></span> elements</li>
  <li><span style="font-style: italic;"><span style="font-weight: bold;">selectionItem</span></span>
elements have <span style="font-style: italic;"><span style="font-weight: bold;">id</span></span> attributes that are used
as id in "paramValue" scheme or in template</li>
</ul>
<p>For <span style="font-weight: bold; font-style: italic;">selectors</span>
that require a single value to make a selection, this can work the same
as above except that the template macro name or parameter name are
defined by <span style="font-weight: bold; font-style: italic;">selection</span>
id value. However, if a <span style="font-weight: bold; font-style: italic;">selectionItem</span>
element is present, then all is the same as above except that the <span style="font-weight: bold; font-style: italic;">selectionItem</span> id
value defines the template macro name or parameter name.<br>
</p>
<p>For <span style="font-weight: bold; font-style: italic;">selectors</span>
that require multiple values to make a selection, <span style="font-weight: bold; font-style: italic;">selectionItem</span>
elements are required for each of the required values. The id of each <span style="font-weight: bold; font-style: italic;">selectionItem</span>
element is used to define the template macro names or parameter names.<br>
</p>
<p>An example DQC that shows the above methods and this method is
available at <a href="./DqcExample-twoDFS.xml">DqcExample-twoDFS.xml</a><br>
</p>
<h3>selectionItem element<br>
</h3>
<pre>&lt;xsd:element name="selectionItem" type="" abstract="true" /&gt;<br>&lt;xsd:complexType name="selectionItemType"&gt;<br>  &lt;xsd:attribute name="id" type="xsd:token" use="required"/&gt;<br>&lt;/xsd:complexType&gt;<br></pre>
<p>The <span style="font-style: italic;"><span style="font-weight: bold;">selectionItem</span></span> element ...
Possible element to indicate that multiple values are required for the
containing selector.<br>
</p>
<h3>selectFromRange2 element<br>
</h3>
<pre>&lt;xsd:element name="selectFromRange2" type="qc:selectFromRange2Type" substitutionGroup="qc:selector" /&gt;<br>&lt;xsd:complexType name="selectFromRange2Type"&gt;<br>  &lt;xsd:complexContent&gt;<br>    &lt;xsd:extension base="qc:selectorType"&gt;<br>      &lt;xsd:sequence&gt;<br>        &lt;xsd:choice&gt;<br>          &lt;xsd:sequence&gt;<br>            &lt;xsd:element ref="qc:selectedMin" /&gt;<br>            &lt;xsd:element ref="qc:selectedMax" /&gt;<br>          &lt;/xsd:sequence&gt;<br>          &lt;xsd:sequence&gt;<br>            &lt;xsd:element ref="qc:selectedPoint" /&gt;<br>            &lt;xsd:element ref="qc:selectedProximity" minOccurs="0" /&gt;<br>          &lt;/xsd:sequence&gt;<br>        &lt;/xsd:choice&gt;<br>        &lt;xsd:element ref="qc:selectedUnits" minOccurs="0" maxOccurs="1" /&gt;<br>      &lt;/xsd:sequence&gt;<br>      &lt;xsd:attribute name="min" type="xsd:float" /&gt;<br>      &lt;xsd:attribute name="max" type="xsd:float" /&gt;<br>      &lt;xsd:attribute name="units" type="xsd:float" /&gt;<br>    &lt;/xsd:extension&gt;<br>  &lt;/xsd:complexContent&gt;<br>&lt;/xsd:complexType&gt;<br><br>&lt;xsd:element name="selectedMin" type="qc:selectedFloatValueType" substitutionGroup="qc:selectionItem" /&gt;<br>&lt;xsd:element name="selectedMax" type="qc:selectedFloatValueType" substitutionGroup="qc:selectionItem" /&gt;<br>&lt;xsd:element name="selectedPoint" type="qc:selectedFloatValueType" substitutionGroup="qc:selectionItem" /&gt;<br>&lt;xsd:element name="selectedProximity" type="qc:selectedProximityValueType" substitutionGroup="qc:selectionItem" /&gt;<br>&lt;xsd:element name="selectedUnits" type="qc:selectedStringValueType" substitutionGroup="qc:selectionItem" /&gt;<br><br>&lt;xsd:complexType name="selectedFloatValueType"&gt;<br>  &lt;xsd:complexContent&gt;<br>    &lt;xsd:extension base="qc:selectionItemType"&gt;<br>      &lt;xsd:attribute name="value" type="xsd:float" /&gt;<br>    &lt;/xsd:extension&gt;<br>  &lt;/xsd:complexContent&gt;<br>&lt;/xsd:complexType&gt;<br><br>&lt;xsd:complexType name="selectedStringValueType"&gt;<br>  &lt;xsd:complexContent&gt;<br>    &lt;xsd:extension base="qc:selectionItemType"&gt;<br>      &lt;xsd:attribute name="value" type="xsd:string" /&gt;<br>    &lt;/xsd:extension&gt;<br>  &lt;/xsd:complexContent&gt;<br>&lt;/xsd:complexType&gt;<br><br>&lt;xsd:complexType name="selectedProximityValueType"&gt;<br>  &lt;xsd:complexContent&gt;<br>    &lt;xsd:extension base="qc:selectionItemType"&gt;<br>      &lt;xsd:attribute name="value" type="qc:proximityType" default="closest" /&gt;<br>    &lt;/xsd:extension&gt;<br>  &lt;/xsd:complexContent&gt;<br>&lt;/xsd:complexType&gt;<br><br>&lt;xsd:simpleType name="proximityType"&gt;<br>  &lt;xsd:restriction base="xsd:token"&gt;<br>    &lt;xsd:enumeration value="closest" /&gt;<br>    &lt;xsd:enumeration value="closestAbove" /&gt;<br>    &lt;xsd:enumeration value="closestBelow" /&gt;<br>  &lt;/xsd:restriction&gt;<br>&lt;/xsd:simpleType&gt;<br></pre>
<p>Example:<br>
</p>
<pre>&lt;selectFromRange name="DateRange" description="The date range ..." required="false"<br>                 min="-5.0" max="0.0" units="days since present"&gt;<br>  &lt;selectedMin id="minDate" /&gt;<br>  &lt;selectedMax id="maxDate" /&gt;<br>&lt;/selectDateRange&gt;</pre>
<p><span style="color: rgb(255, 0, 0);">LOOK</span> Note the
propposed
way of specing the reletive time.</p>
<hr width="100%" size="2">
<h2><a name="Index_of_elements_and_types"></a>Index of elements and types</h2>
<ul>
  <li><a href="#queryCapability_Element">queryCapability</a></li>
  <li><a href="#query_Element">query</a></li>
  <li><a href="#selector_Element">selector</a></li>
  <li><a href="#selectList_Element">selectList</a></li>
  <li><a href="#choice_Element">choice</a></li>
  <li><a href="#selectServiceType_Element">selectServiceType</a></li>
  <li><a href="#serviceType_Element">serviceType</a></li>
  <li><a href="#selectStation_Element">selectStation</a></li>
  <li><a href="#station_Element">station</a></li>
  <li><a href="#location_Element">location</a></li>
  <li><a href="#location3D_Element">location3D</a></li>
  <li><a href="#selectFromRange_Element">selectFromRange</a></li>
  <li><a href="#selectFromDateRange_Element">selectFromDateRange</a></li>
  <li><a href="#selectFromGeoRegion_Element">selectFromGeoRegion</a></li>
  <li><a href="#geoBoundingBox_Element">geoBoundingBox</a></li>
  <li><a href="#userInterface_Element">userInterface<br>
    </a></li>
</ul>
<br>
<hr>
<address><a href="mailto:edavis@ucar.edu">Ethan Davis</a></address>
<!--
  $Log: DqcSpec.html,v $
  Revision 1.4  2004/04/02 21:29:22  edavis
  Reword some descriptions; add more examples; allow both template and
  paramValue construction for selectors that require multiple values for
  a valid selection.

  Revision 1.3  2004/03/03 18:27:04  edavis
  Remove some docs on experimental features, add list of changes since 0.2,
  add selectFromDateRange and selectFromGeoRegion, and clear up some
  explainations.

  Revision 1.2  2004/01/15 19:41:39  edavis
  Some minor changes.

  Revision 1.1  2003/12/20 20:29:41  edavis
  Second draft for the 0.3 version of the
  Dataset Query Capabilities (DQC) schema.

  -->
</body></html>